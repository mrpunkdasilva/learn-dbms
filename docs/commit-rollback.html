<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#E8488B"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="built-on" content="2025-05-09T19:38:45.187143763"><title>Commit e Rollback | Database Management Systems: A Complete Guide</title><script type="application/json" id="virtual-toc-data">[{"id":"vis-o-geral","level":0,"title":"Visão Geral","anchor":"#vis-o-geral"},{"id":"comando-commit","level":0,"title":"Comando COMMIT","anchor":"#comando-commit"},{"id":"comando-rollback","level":0,"title":"Comando ROLLBACK","anchor":"#comando-rollback"},{"id":"commit-vs-rollback-quando-usar","level":0,"title":"Commit vs. Rollback: Quando Usar","anchor":"#commit-vs-rollback-quando-usar"},{"id":"auto-commit","level":0,"title":"Auto-Commit","anchor":"#auto-commit"},{"id":"commit-impl-cito","level":0,"title":"Commit Implícito","anchor":"#commit-impl-cito"},{"id":"pr-ticas-recomendadas","level":0,"title":"Práticas Recomendadas","anchor":"#pr-ticas-recomendadas"},{"id":"conclus-o","level":0,"title":"Conclusão","anchor":"#conclus-o"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.css" rel="stylesheet"><link href="static/custom.css" rel="stylesheet"><link rel="icon" type="image/svg" sizes="16x16" href="images/logo-primary.svg"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Commit e Rollback | Database Management Systems: A Complete Guide"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Database Management Systems: A Complete Guide Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/commit-rollback.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Commit e Rollback | Database Management Systems: A Complete Guide"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/commit-rollback.html#webpage",
    "url": "writerside-documentation/commit-rollback.html",
    "name": "Commit e Rollback | Database Management Systems: A Complete Guide",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "Database Management Systems: A Complete Guide Help"
}</script><!-- End Schema.org --></head><body data-id="commit-rollback" data-main-title="Commit e Rollback" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="sql-fundamentals.md|Fundamentos SQL///sql-tcl.md|Linguagem de Controle de Transação (TCL)"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Database Management Systems: A Complete Guide  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="commit-rollback" id="commit-rollback.md">Commit e Rollback</h1><section class="chapter"><h2 id="vis-o-geral" data-toc="vis-o-geral">Vis&atilde;o Geral</h2><p id="-l0mxh0_11">Os comandos <code class="code" id="-l0mxh0_13">COMMIT</code> e <code class="code" id="-l0mxh0_14">ROLLBACK</code> s&atilde;o fundamentais para o controle transacional em bancos de dados. Eles determinam o destino final das opera&ccedil;&otilde;es realizadas dentro de uma transa&ccedil;&atilde;o.</p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 532.125 567.984375" height="567.984375" class="flowchart" xmlns="http://www.w3.org/2000/svg" width="532.125" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_B_0" d="M267.398,62L267.398,66.167C267.398,70.333,267.398,78.667,267.398,84.917C267.398,91.167,267.398,95.333,267.398,98.833C267.398,102.333,267.398,105.167,267.398,106.583L267.398,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_C_1" d="M267.398,166L267.398,170.167C267.398,174.333,267.398,182.667,267.44,188.958C267.482,195.25,267.565,199.5,267.635,203.083C267.706,206.667,267.763,209.584,267.791,211.042L267.82,212.501"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_D_2" d="M234.108,294.694L216.068,306.409C198.028,318.124,161.947,341.554,143.907,356.353C125.867,371.151,125.867,377.318,125.867,382.818C125.867,388.318,125.867,393.151,125.867,395.568L125.867,397.984"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_E_3" d="M301.689,294.694L319.562,306.409C337.436,318.124,373.183,341.554,391.056,356.353C408.93,371.151,408.93,377.318,408.93,382.818C408.93,388.318,408.93,393.151,408.93,395.568L408.93,397.984"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_F_4" d="M125.867,455.984L125.867,460.151C125.867,464.318,125.867,472.651,125.867,478.901C125.867,485.151,125.867,489.318,125.867,492.818C125.867,496.318,125.867,499.151,125.867,500.568L125.867,501.984"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_E_G_5" d="M408.93,455.984L408.93,460.151C408.93,464.318,408.93,472.651,408.93,478.901C408.93,485.151,408.93,489.318,408.93,492.818C408.93,496.318,408.93,499.151,408.93,500.568L408.93,501.984"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g transform="translate(125.8671875, 364.984375)" class="edgeLabel"><g transform="translate(-30.7734375, -12)" class="label"><foreignObject height="24" width="61.546875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>Sucesso</p></span></div></foreignObject></g></g><g transform="translate(408.9296875, 364.984375)" class="edgeLabel"><g transform="translate(-20.078125, -12)" class="label"><foreignObject height="24" width="40.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>Falha</p></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(267.3984375, 35)" id="flowchart-A-654" class="node default"><rect height="54" width="229.03125" y="-27" x="-114.515625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-84.515625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="169.03125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>BEGIN TRANSACTION</p></span></div></foreignObject></g></g><g transform="translate(267.3984375, 139)" id="flowchart-B-655" class="node default"><rect height="54" width="176.8125" y="-27" x="-88.40625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-58.40625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="116.8125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Operações DML</p></span></div></foreignObject></g></g><g transform="translate(267.3984375, 271.9921875)" id="flowchart-C-657" class="node default"><polygon transform="translate(-55.9921875,55.9921875)" class="label-container" points="55.9921875,0 111.984375,-55.9921875 55.9921875,-111.984375 0,-55.9921875"></polygon><g transform="translate(-28.9921875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="57.984375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Decisão</p></span></div></foreignObject></g></g><g transform="translate(125.8671875, 428.984375)" id="flowchart-D-659" class="node default"><rect height="54" width="125.03125" y="-27" x="-62.515625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.515625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="65.03125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>COMMIT</p></span></div></foreignObject></g></g><g transform="translate(408.9296875, 428.984375)" id="flowchart-E-661" class="node default"><rect height="54" width="145.5625" y="-27" x="-72.78125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-42.78125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="85.5625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>ROLLBACK</p></span></div></foreignObject></g></g><g transform="translate(125.8671875, 532.984375)" id="flowchart-F-663" class="node default"><rect height="54" width="235.734375" y="-27" x="-117.8671875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-87.8671875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="175.734375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Alterações Permanentes</p></span></div></foreignObject></g></g><g transform="translate(408.9296875, 532.984375)" id="flowchart-G-665" class="node default"><rect height="54" width="230.390625" y="-27" x="-115.1953125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-85.1953125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="170.390625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Alterações Descartadas</p></span></div></foreignObject></g></g></g></g></g></svg></section><section class="chapter"><h2 id="comando-commit" data-toc="comando-commit">Comando COMMIT</h2><p id="-l0mxh0_15">O comando <code class="code" id="-l0mxh0_19">COMMIT</code> finaliza a transa&ccedil;&atilde;o atual e torna permanentes todas as altera&ccedil;&otilde;es realizadas desde o in&iacute;cio da transa&ccedil;&atilde;o.</p><section class="chapter"><h3 id="sintaxe" data-toc="sintaxe">Sintaxe</h3><div class="code-block" data-lang="sql">
COMMIT [TRANSACTION];
-- ou simplesmente
COMMIT;
</div></section><section class="chapter"><h3 id="efeitos-do-commit" data-toc="efeitos-do-commit">Efeitos do COMMIT</h3><ol class="list _decimal" id="-l0mxh0_21" type="1"><li class="list__item" id="-l0mxh0_22"><p id="-l0mxh0_27"><span class="control" id="-l0mxh0_28">Persist&ecirc;ncia</span>: Todas as altera&ccedil;&otilde;es se tornam permanentes no banco de dados</p></li><li class="list__item" id="-l0mxh0_23"><p id="-l0mxh0_29"><span class="control" id="-l0mxh0_30">Visibilidade</span>: As altera&ccedil;&otilde;es se tornam vis&iacute;veis para outras transa&ccedil;&otilde;es</p></li><li class="list__item" id="-l0mxh0_24"><p id="-l0mxh0_31"><span class="control" id="-l0mxh0_32">Libera&ccedil;&atilde;o de Bloqueios</span>: Todos os bloqueios adquiridos pela transa&ccedil;&atilde;o s&atilde;o liberados</p></li><li class="list__item" id="-l0mxh0_25"><p id="-l0mxh0_33"><span class="control" id="-l0mxh0_34">Pontos de Salvamento</span>: Todos os savepoints criados na transa&ccedil;&atilde;o s&atilde;o descartados</p></li><li class="list__item" id="-l0mxh0_26"><p id="-l0mxh0_35"><span class="control" id="-l0mxh0_36">Finaliza&ccedil;&atilde;o</span>: A transa&ccedil;&atilde;o &eacute; encerrada e uma nova transa&ccedil;&atilde;o &eacute; iniciada automaticamente em alguns SGBDs</p></li></ol></section><section class="chapter"><h3 id="exemplos-de-commit" data-toc="exemplos-de-commit">Exemplos de COMMIT</h3><section class="chapter"><h4 id="exemplo-b-sico" data-toc="exemplo-b-sico">Exemplo B&aacute;sico</h4><div class="code-block" data-lang="sql">
BEGIN;
    INSERT INTO clientes (nome, email) 
    VALUES ('Maria Silva', 'maria@email.com');
    
    UPDATE produtos 
    SET estoque = estoque - 1 
    WHERE id = 101;
COMMIT;
</div></section><section class="chapter"><h4 id="commit-condicional" data-toc="commit-condicional">Commit Condicional</h4><div class="code-block" data-lang="sql">
BEGIN;
    UPDATE contas 
    SET saldo = saldo - 1000 
    WHERE id = 1;
    
    UPDATE contas 
    SET saldo = saldo + 1000 
    WHERE id = 2;
    
    -- Verificar se ambas as contas existem
    IF (SELECT COUNT(*) FROM contas WHERE id IN (1, 2)) = 2 THEN
        COMMIT;
    ELSE
        ROLLBACK;
    END IF;
</div></section></section></section><section class="chapter"><h2 id="comando-rollback" data-toc="comando-rollback">Comando ROLLBACK</h2><p id="-l0mxh0_41">O comando <code class="code" id="-l0mxh0_45">ROLLBACK</code> desfaz todas as altera&ccedil;&otilde;es realizadas desde o in&iacute;cio da transa&ccedil;&atilde;o ou desde um ponto de salvamento espec&iacute;fico.</p><section class="chapter"><h3 id="sintaxe" data-toc="sintaxe">Sintaxe</h3><div class="code-block" data-lang="sql">
ROLLBACK [TRANSACTION];
-- ou simplesmente
ROLLBACK;

-- Para rollback parcial até um savepoint
ROLLBACK [TRANSACTION] TO [SAVEPOINT] savepoint_name;
</div></section><section class="chapter"><h3 id="efeitos-do-rollback" data-toc="efeitos-do-rollback">Efeitos do ROLLBACK</h3><ol class="list _decimal" id="-l0mxh0_47" type="1"><li class="list__item" id="-l0mxh0_48"><p id="-l0mxh0_52"><span class="control" id="-l0mxh0_53">Revers&atilde;o</span>: Todas as altera&ccedil;&otilde;es s&atilde;o desfeitas</p></li><li class="list__item" id="-l0mxh0_49"><p id="-l0mxh0_54"><span class="control" id="-l0mxh0_55">Libera&ccedil;&atilde;o de Bloqueios</span>: Todos os bloqueios adquiridos pela transa&ccedil;&atilde;o s&atilde;o liberados</p></li><li class="list__item" id="-l0mxh0_50"><p id="-l0mxh0_56"><span class="control" id="-l0mxh0_57">Pontos de Salvamento</span>: Todos os savepoints s&atilde;o descartados (exceto em rollback parcial)</p></li><li class="list__item" id="-l0mxh0_51"><p id="-l0mxh0_58"><span class="control" id="-l0mxh0_59">Finaliza&ccedil;&atilde;o</span>: A transa&ccedil;&atilde;o &eacute; encerrada e uma nova transa&ccedil;&atilde;o &eacute; iniciada automaticamente em alguns SGBDs</p></li></ol></section><section class="chapter"><h3 id="exemplos-de-rollback" data-toc="exemplos-de-rollback">Exemplos de ROLLBACK</h3><section class="chapter"><h4 id="rollback-completo" data-toc="rollback-completo">Rollback Completo</h4><div class="code-block" data-lang="sql">
BEGIN;
    DELETE FROM pedidos WHERE cliente_id = 101;
    
    -- Ops, não era para excluir todos os pedidos!
    ROLLBACK;
</div></section><section class="chapter"><h4 id="rollback-com-tratamento-de-erros" data-toc="rollback-com-tratamento-de-erros">Rollback com Tratamento de Erros</h4><div class="code-block" data-lang="sql">
BEGIN;
    DECLARE EXIT HANDLER FOR SQLEXCEPTION
    BEGIN
        ROLLBACK;
        SELECT 'Transação abortada devido a erro' AS mensagem;
    END;
    
    UPDATE produtos SET preco = preco * 1.1;
    INSERT INTO log_alteracoes (tabela, descricao) 
    VALUES ('produtos', 'Aumento de 10% nos preços');
    
    COMMIT;
END;
</div></section></section></section><section class="chapter"><h2 id="commit-vs-rollback-quando-usar" data-toc="commit-vs-rollback-quando-usar">Commit vs. Rollback: Quando Usar</h2><section class="chapter"><h3 id="use-commit-quando" data-toc="use-commit-quando">Use COMMIT quando:</h3><ol class="list _decimal" id="-l0mxh0_66" type="1"><li class="list__item" id="-l0mxh0_67"><p id="-l0mxh0_70"><span class="control" id="-l0mxh0_71">Opera&ccedil;&otilde;es Bem-Sucedidas</span>: Todas as opera&ccedil;&otilde;es foram conclu&iacute;das com sucesso</p></li><li class="list__item" id="-l0mxh0_68"><p id="-l0mxh0_72"><span class="control" id="-l0mxh0_73">Dados V&aacute;lidos</span>: Os dados est&atilde;o em um estado consistente</p></li><li class="list__item" id="-l0mxh0_69"><p id="-l0mxh0_74"><span class="control" id="-l0mxh0_75">Ponto de Finaliza&ccedil;&atilde;o</span>: Voc&ecirc; atingiu um ponto l&oacute;gico de conclus&atilde;o no processamento</p></li></ol></section><section class="chapter"><h3 id="use-rollback-quando" data-toc="use-rollback-quando">Use ROLLBACK quando:</h3><ol class="list _decimal" id="-l0mxh0_76" type="1"><li class="list__item" id="-l0mxh0_77"><p id="-l0mxh0_81"><span class="control" id="-l0mxh0_82">Erros Detectados</span>: Ocorreram erros durante o processamento</p></li><li class="list__item" id="-l0mxh0_78"><p id="-l0mxh0_83"><span class="control" id="-l0mxh0_84">Dados Inv&aacute;lidos</span>: Os dados n&atilde;o atendem &agrave;s regras de neg&oacute;cio ou restri&ccedil;&otilde;es</p></li><li class="list__item" id="-l0mxh0_79"><p id="-l0mxh0_85"><span class="control" id="-l0mxh0_86">Opera&ccedil;&atilde;o Cancelada</span>: O usu&aacute;rio ou o sistema decidiu cancelar a opera&ccedil;&atilde;o</p></li><li class="list__item" id="-l0mxh0_80"><p id="-l0mxh0_87"><span class="control" id="-l0mxh0_88">Teste ou Simula&ccedil;&atilde;o</span>: Voc&ecirc; est&aacute; apenas testando ou simulando opera&ccedil;&otilde;es</p></li></ol></section></section><section class="chapter"><h2 id="auto-commit" data-toc="auto-commit">Auto-Commit</h2><p id="-l0mxh0_89">Muitos SGBDs e ferramentas de cliente possuem um modo &quot;auto-commit&quot; que automaticamente confirma cada instru&ccedil;&atilde;o SQL individual como uma transa&ccedil;&atilde;o separada.</p><section class="chapter"><h3 id="habilitando-desabilitando-auto-commit" data-toc="habilitando-desabilitando-auto-commit">Habilitando/Desabilitando Auto-Commit</h3><div class="code-block" data-lang="sql">
-- PostgreSQL
SET autocommit = ON; -- ou OFF

-- MySQL
SET autocommit = 1; -- ou 0

-- SQL Server
SET IMPLICIT_TRANSACTIONS OFF; -- auto-commit ON
SET IMPLICIT_TRANSACTIONS ON;  -- auto-commit OFF

-- Oracle
-- Sempre requer COMMIT explícito, exceto para DDL
</div></section><section class="chapter"><h3 id="implica-es-do-auto-commit" data-toc="implica-es-do-auto-commit">Implica&ccedil;&otilde;es do Auto-Commit</h3><ul class="list _bullet" id="-l0mxh0_93"><li class="list__item" id="-l0mxh0_94"><p id="-l0mxh0_96"><span class="control" id="-l0mxh0_97">Vantagens</span>: Simplicidade, menor risco de deixar transa&ccedil;&otilde;es abertas</p></li><li class="list__item" id="-l0mxh0_95"><p id="-l0mxh0_98"><span class="control" id="-l0mxh0_99">Desvantagens</span>: Perda de atomicidade para opera&ccedil;&otilde;es m&uacute;ltiplas, potencial redu&ccedil;&atilde;o de desempenho</p></li></ul></section></section><section class="chapter"><h2 id="commit-impl-cito" data-toc="commit-impl-cito">Commit Impl&iacute;cito</h2><p id="-l0mxh0_100">Algumas opera&ccedil;&otilde;es podem causar um commit impl&iacute;cito, mesmo dentro de uma transa&ccedil;&atilde;o expl&iacute;cita:</p><ol class="list _decimal" id="-l0mxh0_101" type="1"><li class="list__item" id="-l0mxh0_103"><p id="-l0mxh0_107"><span class="control" id="-l0mxh0_108">Comandos DDL</span>: CREATE, ALTER, DROP, etc.</p></li><li class="list__item" id="-l0mxh0_104"><p id="-l0mxh0_109"><span class="control" id="-l0mxh0_110">Comandos DCL</span>: GRANT, REVOKE, etc.</p></li><li class="list__item" id="-l0mxh0_105"><p id="-l0mxh0_111"><span class="control" id="-l0mxh0_112">Comandos de Administra&ccedil;&atilde;o</span>: ANALYZE, VACUUM, etc.</p></li><li class="list__item" id="-l0mxh0_106"><p id="-l0mxh0_113"><span class="control" id="-l0mxh0_114">Conex&atilde;o/Desconex&atilde;o</span>: Dependendo do SGBD e configura&ccedil;&atilde;o</p></li></ol><div class="code-block" data-lang="sql">
BEGIN;
    INSERT INTO tabela1 VALUES (1, 'teste');
    
    -- Em muitos SGBDs, isto causa um commit implícito
    CREATE INDEX idx_tabela1 ON tabela1(coluna1);
    
    -- Esta operação já estará em uma nova transação
    UPDATE tabela2 SET coluna1 = 'valor';
COMMIT;
</div></section><section class="chapter"><h2 id="pr-ticas-recomendadas" data-toc="pr-ticas-recomendadas">Pr&aacute;ticas Recomendadas</h2><section class="chapter"><h3 id="1-transa-es-curtas-e-focadas" data-toc="1-transa-es-curtas-e-focadas">1. Transa&ccedil;&otilde;es Curtas e Focadas</h3><div class="code-block" data-lang="sql">
-- Preferível: Transações pequenas e focadas
BEGIN;
    UPDATE estoque SET quantidade = quantidade - 10 WHERE produto_id = 101;
    INSERT INTO movimentos (produto_id, quantidade, tipo) VALUES (101, 10, 'SAÍDA');
COMMIT;

BEGIN;
    -- Outra operação lógica separada
    UPDATE faturamento SET total = total + 1000 WHERE mes = CURRENT_MONTH;
COMMIT;
</div></section><section class="chapter"><h3 id="2-tratamento-adequado-de-erros" data-toc="2-tratamento-adequado-de-erros">2. Tratamento Adequado de Erros</h3><div class="code-block" data-lang="sql">
BEGIN;
    SAVEPOINT antes_operacoes_criticas;
    
    -- Tente executar operações críticas
    UPDATE contas SET saldo = saldo - 5000 WHERE id = 101;
    
    -- Verifique se a conta tem saldo suficiente
    IF (SELECT saldo FROM contas WHERE id = 101) &lt; 0 THEN
        -- Desfaça apenas as operações críticas
        ROLLBACK TO antes_operacoes_criticas;
        -- Continue com outras operações
    ELSE
        -- Prossiga com o restante da transação
    END IF;
    
    -- Operações não críticas
    INSERT INTO log_atividades (descricao) VALUES ('Tentativa de saque');
    
COMMIT;
</div></section><section class="chapter"><h3 id="3-evite-transa-es-de-longa-dura-o" data-toc="3-evite-transa-es-de-longa-dura-o">3. Evite Transa&ccedil;&otilde;es de Longa Dura&ccedil;&atilde;o</h3><div class="code-block" data-lang="sql">
-- Evite:
BEGIN;
    -- Processamento em lote de milhões de registros
    UPDATE grande_tabela SET status = 'PROCESSADO' WHERE status = 'PENDENTE';
    -- Pode levar muito tempo e bloquear outros processos
COMMIT;

-- Prefira:
DO $$
DECLARE
    batch_size INT := 1000;
    total_updated INT := 0;
BEGIN
    LOOP
        BEGIN
            UPDATE grande_tabela 
            SET status = 'PROCESSADO' 
            WHERE id IN (
                SELECT id 
                FROM grande_tabela 
                WHERE status = 'PENDENTE' 
                LIMIT batch_size
            );
            
            GET DIAGNOSTICS total_updated = ROW_COUNT;
            
            EXIT WHEN total_updated = 0;
            
            COMMIT;
        END;
    END LOOP;
END $$;
</div></section></section><section class="chapter"><h2 id="conclus-o" data-toc="conclus-o">Conclus&atilde;o</h2><p id="-l0mxh0_121">Os comandos <code class="code" id="-l0mxh0_123">COMMIT</code> e <code class="code" id="-l0mxh0_124">ROLLBACK</code> s&atilde;o ferramentas essenciais para garantir a integridade dos dados em sistemas de banco de dados. Eles permitem que os desenvolvedores controlem precisamente quando as altera&ccedil;&otilde;es devem ser aplicadas permanentemente ou descartadas.</p><p id="-l0mxh0_122">O uso adequado desses comandos, combinado com uma estrat&eacute;gia bem planejada de transa&ccedil;&otilde;es, &eacute; fundamental para desenvolver aplica&ccedil;&otilde;es robustas que mantenham a consist&ecirc;ncia dos dados mesmo em cen&aacute;rios de falha ou concorr&ecirc;ncia.</p></section><div class="last-modified">09 maio 2025</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="transaction-basics.html" class="navigation-links__prev">Fundamentos de Transa&ccedil;&otilde;es</a><a href="savepoint-management.html" class="navigation-links__next">Gerenciamento de Savepoints</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.js"></script></body></html>